name: ЁЯФБ Auto Login & Refresh Token (AynaOTT)

on:
  schedule:
    - cron: "*/30 * * * *"   # ржкрзНрж░рждрж┐ рзйрзж ржорж┐ржирж┐ржЯрзЗ рж░рж╛ржи
  workflow_dispatch:          # ржорзНржпрж╛ржирзБрзЯрж╛рж▓рж┐ ржЪрж╛рж▓рж╛ржирзЛрж░ ржЕржкрж╢ржи

jobs:
  update-token:
    runs-on: ubuntu-latest

    permissions:
      contents: write   # Repo-рждрзЗ commit ржХрж░рж╛рж░ ржЕржирзБржорждрж┐

    steps:
      - name: ЁЯУе Checkout Repository
        uses: actions/checkout@v4

      - name: ЁЯФз Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.10"

      - name: ЁЯУж Install Dependencies
        run: |
          pip install requests

      - name: ЁЯФД Run Token Manager (Login + Refresh)
        run: |
          python3 ayna_token_manager.py

      - name: ЁЯТ╛ Commit Updated Token
        run: |
          git config --global user.name "GitHub Actions"
          git config --global user.email "actions@github.com"
          git add token.json || true
          git commit -m "ЁЯФД Auto-update token.json" || true
          git push || true
